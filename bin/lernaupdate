#!/usr/bin/env node

const meow = require("meow");
const chalk = require("chalk");

const { input, flags } = meow(
  `
  Usage: lernaupdate <project-directory>

  Options:
    --dedupe, -d  List only dependencies that have a version conflict between one or more packages
    --dependency, --dep  Specifiy dependency to update/add (Skips interactive step)
    --packages  Specifiy packages (comma-separated Glob-patterns) in which to update/add dependency (Skips interactive step)

  Examples:
    $ lernaupdate ./myproject --dedupe

    $ lernaupdate ./myproject --dependency "lodash@latest"
    $ lernaupdate ./myproject --dependency "react@^1.6.1"

    $ lernaupdate ./myproject --packages "packages/components,packages/utils,packages/dev-server"
    $ lernaupdate ./myproject --packages "packages/test-*,packages/fixtures"
    $ lernaupdate ./myproject --packages "packages/*"
`,
  {
    flags: {
      dedupe: {
        type: "boolean",
        alias: "d",
      },
      dependency: {
        type: "string",
      },
      packages: {
        type: "string",
      },
    },
  }
);

require("../src/index.js")({ input, flags }).catch(err => {
  console.log(chalk`{red.bold An error occurred:}\n{bold ${err}}`);
  process.exit(1);
});
